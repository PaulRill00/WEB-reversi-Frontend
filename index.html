<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Javascript getting started</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
      integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
    integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
    crossorigin="anonymous"></script>

  <script src="js/feedbackWidget.js" ></script>
  <script src="js/game.js" ></script>
</head>
<body>

<div id="feedback">
</div>

<div id="feedback-success" class="alert alert-success" role="alert" style="display:none">
  <p>Veel succes met deze module!</p>
</div>

<div id="feedback-danger" class="alert alert-danger" role="alert" style="display:none">
  <p>Pas op voor loslopende bits.</p>
</div>

<script>

$(() => {  
  let feedbackWidget = new FeedbackWidget('feedback-success');

  const getWeatherData = () => {
    const apiKey = "3bedf08fa201acca2754e7fdbc6894f8";
    const url = "http://api.openweathermap.org/data/2.5/weather?q=zwolle&apikey=" + apiKey;

    return $.get(url);
  }

  getWeatherData().then((res) => {
    feedbackWidget.log({
      'message': JSON.stringify(res),
      'type': 'success'
    });
  })

  getWeatherData().then(d => {
    return {
      data: d,
      meta: 'vanuit eerste schakel van de chain'
    }
  }).then(r => {
    console.log(`Bericht ontvangen in tweede schakel: ${r.meta}`);
    throw new Error('Error gegooid');
  }).catch(e => {
    console.log(`Error opgevangen, error bericht: ${e.message}`);
  });

});


</script>

</body>
</html>
